(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{5573:function(e,t,a){Promise.resolve().then(a.bind(a,4420))},4420:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var r=a(7437),s=a(2265),l=a(9376),o=a(7648),n=a(8734),i=a(3464);function c(){(0,l.useRouter)();let{isAuthenticated:e,isLoading:t,userName:a,user:c,logout:d}=(0,n.a)(),[u,m]=(0,s.useState)([]),[x,h]=(0,s.useState)([]),[g,p]=(0,s.useState)(null),[b,f]=(0,s.useState)(""),[y,v]=(0,s.useState)(!1),[j,w]=(0,s.useState)(!0),N=(0,s.useRef)(null),k="https://mean-tiger-51.loca.lt";(0,s.useEffect)(()=>{var e;null===(e=N.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[u]),(0,s.useEffect)(()=>{e&&(null==c?void 0:c.id)&&S()},[e,null==c?void 0:c.id]);let S=async()=>{try{let e=localStorage.getItem("token");if(!e||!(null==c?void 0:c.id))return;let t=(await i.Z.get("".concat(k,"/api/").concat(c.id,"/conversations"),{headers:{Authorization:"Bearer ".concat(e)}})).data.conversations.map(e=>({id:e.id,createdAt:new Date(e.created_at),messageCount:e.message_count,preview:e.preview}));h(t)}catch(e){console.error("Failed to load conversations:",e)}},C=async e=>{try{let t=localStorage.getItem("token");if(!t||!(null==c?void 0:c.id))return;let a=(await i.Z.get("".concat(k,"/api/").concat(c.id,"/conversations/").concat(e),{headers:{Authorization:"Bearer ".concat(t)}})).data.messages.map(e=>({id:e.id.toString(),role:e.role,content:e.content,timestamp:new Date(e.created_at)}));m(a),p(e)}catch(e){console.error("Failed to load messages:",e)}},D=async t=>{if(t.preventDefault(),!b.trim()||!e||!(null==c?void 0:c.id))return;let a=b.trim(),r={id:Date.now().toString(),role:"user",content:a,timestamp:new Date};m(e=>[...e,r]),f(""),v(!0);try{let e=localStorage.getItem("token");if(!e)throw Error("No authentication token found");let t=await i.Z.post("".concat(k,"/api/").concat(c.id,"/chat"),{message:a,conversation_id:g},{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});p(t.data.conversation_id);let r={id:Date.now().toString(),role:"assistant",content:t.data.response,toolCalls:t.data.tool_calls,timestamp:new Date};m(e=>[...e,r]),S()}catch(t){console.error("Chat error:",t);let e={id:Date.now().toString(),role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date};m(t=>[...t,e])}finally{v(!1)}};return t?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("span",{className:"text-lg font-bold text-gray-600",children:"Loading..."})]})}):e?(0,r.jsxs)("div",{className:"flex h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 overflow-hidden",children:[(0,r.jsxs)("div",{className:"".concat(j?"w-64":"w-0"," transition-all duration-300 bg-white border-r border-gray-200 overflow-y-auto flex flex-col shadow-lg"),children:[(0,r.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,r.jsx)("h2",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"\uD83E\uDD16 AI Chat"})}),(0,r.jsxs)("div",{className:"p-4 flex-1",children:[(0,r.jsx)("button",{onClick:()=>{m([]),p(null),f("")},className:"w-full px-4 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold transition",children:"+ New Chat"}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-2 py-2",children:"Recent Chats"}),(0,r.jsx)("div",{className:"space-y-2",children:0===x.length?(0,r.jsx)("p",{className:"text-xs text-gray-400 px-2 py-3",children:"No conversations yet"}):x.map(e=>(0,r.jsxs)("button",{onClick:()=>C(e.id),className:"w-full text-left px-3 py-2 rounded-lg transition ".concat(g===e.id?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,r.jsxs)("p",{className:"text-sm truncate",children:["Chat ",e.id]}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:[e.messageCount," messages"]})]},e.id))})]})]}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-200 space-y-2",children:[(0,r.jsxs)(o.default,{href:"/dashboard",className:"w-full flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Dashboard"]}),(0,r.jsxs)(o.default,{href:"/",className:"w-full flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Home"]}),(0,r.jsxs)("div",{className:"pt-2 border-t border-gray-200",children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Logged in as"}),(0,r.jsx)("p",{className:"font-semibold text-gray-800 truncate",children:a})]}),(0,r.jsxs)("button",{onClick:()=>{d(),window.location.href="".concat("/hackaton2pages","/")},className:"w-full flex items-center gap-2 px-4 py-2 rounded-lg bg-red-50 hover:bg-red-100 text-red-600 font-medium transition",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]})]})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,r.jsxs)("div",{className:"border-b border-gray-200 bg-white shadow-sm h-16 flex items-center px-6 justify-between sticky top-0 z-10",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>w(!j),className:"p-2 hover:bg-gray-100 rounded-lg transition",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),(0,r.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"AI Todo Assistant"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(o.default,{href:"/dashboard",className:"px-4 py-2 rounded-lg bg-blue-100 hover:bg-blue-200 text-blue-700 font-medium transition text-sm",children:"Dashboard"}),(0,r.jsx)(o.default,{href:"/",className:"px-4 py-2 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium transition text-sm",children:"Home"})]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-6 space-y-4 bg-gradient-to-br from-blue-50/50 via-white to-purple-50/50",children:0===u.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,r.jsxs)("div",{className:"text-center space-y-4 bg-white rounded-2xl shadow-lg p-8 max-w-md",children:[(0,r.jsx)("div",{className:"text-5xl",children:"\uD83D\uDCAC"}),(0,r.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Start a conversation"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Ask me to help you manage your tasks. Try:"}),(0,r.jsxs)("div",{className:"text-left bg-gray-50 rounded-lg p-4 space-y-2",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700",children:'\uD83D\uDCDD "Add task: Complete Phase-3"'}),(0,r.jsx)("p",{className:"text-sm text-gray-700",children:'\uD83D\uDCCB "Show my tasks"'}),(0,r.jsx)("p",{className:"text-sm text-gray-700",children:'âœ… "Mark task 1 as complete"'})]})]})}):(0,r.jsxs)(r.Fragment,{children:[u.map(e=>(0,r.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-xs lg:max-w-md xl:max-w-lg px-4 py-3 rounded-2xl shadow-md ".concat("user"===e.role?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"bg-white text-gray-800 border border-gray-200"),children:[(0,r.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),e.toolCalls&&e.toolCalls.length>0&&(0,r.jsxs)("div",{className:"mt-2 pt-2 border-t ".concat("user"===e.role?"border-white/30":"border-gray-200"),children:[(0,r.jsx)("p",{className:"text-xs font-semibold ".concat("user"===e.role?"text-white/80":"text-gray-500"),children:"Used tools:"}),(0,r.jsx)("ul",{className:"text-xs space-y-1 mt-1",children:e.toolCalls.map(t=>(0,r.jsxs)("li",{className:"flex items-center gap-2 ".concat("user"===e.role?"text-white/70":"text-gray-600"),children:[(0,r.jsx)("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),t]},t))})]}),(0,r.jsx)("time",{className:"text-xs mt-2 block ".concat("user"===e.role?"text-white/60":"text-gray-400"),children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id)),(0,r.jsx)("div",{ref:N})]})}),(0,r.jsx)("form",{onSubmit:D,className:"border-t border-gray-200 bg-white shadow-lg p-4",children:(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsx)("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Type your message... (e.g., 'Add task: Buy groceries')",disabled:y,className:"flex-1 px-4 py-3 rounded-lg bg-gray-100 border border-gray-300 text-gray-900 placeholder:text-gray-400 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 disabled:opacity-50 transition"}),(0,r.jsx)("button",{type:"submit",disabled:y||!b.trim(),className:"px-6 py-3 rounded-lg bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition transform hover:scale-[1.02] active:scale-[0.98]",children:y?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):"Send"})]})})]})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center space-y-4 bg-white rounded-2xl shadow-xl p-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"\uD83E\uDD16 AI Chat"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Please sign in to use the chatbot"}),(0,r.jsx)(o.default,{href:"/signin",className:"inline-block bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 transition-all",children:"Sign In"})]})})}function d(){return(0,r.jsx)(c,{})}},8734:function(e,t,a){"use strict";a.d(t,{a:function(){return s}});var r=a(2265);function s(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(!0),[l,o]=(0,r.useState)(null),[n,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("userId"),r=localStorage.getItem("userName"),l=localStorage.getItem("userEmail");e&&a?(o(e),i(parseInt(a)),d(r),m(l),t(!0)):(t(!1),o(null),i(null),d(null),m(null)),s(!1)},[]),{isAuthenticated:e,isLoading:a,token:l,userId:n,userName:c,userEmail:u,user:n?{id:n,name:c||"",email:u||""}:null,login:(e,a,r,s)=>{localStorage.setItem("token",e),localStorage.setItem("userId",a.toString()),localStorage.setItem("userName",r),localStorage.setItem("userEmail",s),o(e),i(a),d(r),m(s),t(!0)},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),o(null),i(null),d(null),m(null),t(!1)}}}}},function(e){e.O(0,[648,301,971,117,744],function(){return e(e.s=5573)}),_N_E=e.O()}]);